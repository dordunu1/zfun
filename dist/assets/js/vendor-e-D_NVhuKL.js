import{cw as pe,cx as F}from"./react-CrwUxJqE.js";import{j as K,d as me}from"./vendor-j-D_xkZiPL.js";import{p as Oe}from"./vendor-p-RCdGx5qR.js";import{al as G,am as Ne}from"./vendor-@-CStnVm7d.js";import{b as Ae}from"./vendor-f-CRLubUDi.js";import{l as Me}from"./vendor-a-GLtA6KsH.js";import{i as je}from"./vendor-x-D1rEFg7f.js";var ge={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(u,c,f){this.fn=u,this.context=c,this.once=f||!1}function o(u,c,f,h,d){if(typeof f!="function")throw new TypeError("The listener must be a function");var y=new s(f,h||u,d),_=r?r+c:c;return u._events[_]?u._events[_].fn?u._events[_]=[u._events[_],y]:u._events[_].push(y):(u._events[_]=y,u._eventsCount++),u}function i(u,c){--u._eventsCount===0?u._events=new n:delete u._events[c]}function a(){this._events=new n,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],f,h;if(this._eventsCount===0)return c;for(h in f=this._events)t.call(f,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(f)):c},a.prototype.listeners=function(c){var f=r?r+c:c,h=this._events[f];if(!h)return[];if(h.fn)return[h.fn];for(var d=0,y=h.length,_=new Array(y);d<y;d++)_[d]=h[d].fn;return _},a.prototype.listenerCount=function(c){var f=r?r+c:c,h=this._events[f];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,f,h,d,y,_){var E=r?r+c:c;if(!this._events[E])return!1;var g=this._events[E],w=arguments.length,p,l;if(g.fn){switch(g.once&&this.removeListener(c,g.fn,void 0,!0),w){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,f),!0;case 3:return g.fn.call(g.context,f,h),!0;case 4:return g.fn.call(g.context,f,h,d),!0;case 5:return g.fn.call(g.context,f,h,d,y),!0;case 6:return g.fn.call(g.context,f,h,d,y,_),!0}for(l=1,p=new Array(w-1);l<w;l++)p[l-1]=arguments[l];g.fn.apply(g.context,p)}else{var k=g.length,B;for(l=0;l<k;l++)switch(g[l].once&&this.removeListener(c,g[l].fn,void 0,!0),w){case 1:g[l].fn.call(g[l].context);break;case 2:g[l].fn.call(g[l].context,f);break;case 3:g[l].fn.call(g[l].context,f,h);break;case 4:g[l].fn.call(g[l].context,f,h,d);break;default:if(!p)for(B=1,p=new Array(w-1);B<w;B++)p[B-1]=arguments[B];g[l].fn.apply(g[l].context,p)}}return!0},a.prototype.on=function(c,f,h){return o(this,c,f,h,!1)},a.prototype.once=function(c,f,h){return o(this,c,f,h,!0)},a.prototype.removeListener=function(c,f,h,d){var y=r?r+c:c;if(!this._events[y])return this;if(!f)return i(this,y),this;var _=this._events[y];if(_.fn)_.fn===f&&(!d||_.once)&&(!h||_.context===h)&&i(this,y);else{for(var E=0,g=[],w=_.length;E<w;E++)(_[E].fn!==f||d&&!_[E].once||h&&_[E].context!==h)&&g.push(_[E]);g.length?this._events[y]=g.length===1?g[0]:g:i(this,y)}return this},a.prototype.removeAllListeners=function(c){var f;return c?(f=r?r+c:c,this._events[f]&&i(this,f)):(this._events=new n,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a})(ge);var Se=ge.exports;const kr=pe(Se);var Lr=function(t){for(var r=[],n=t.length,s=0;s<n;s++){var o=t.charCodeAt(s);if(o>=55296&&o<=56319&&n>s+1){var i=t.charCodeAt(s+1);i>=56320&&i<=57343&&(o=(o-55296)*1024+i-56320+65536,s+=1)}if(o<128){r.push(o);continue}if(o<2048){r.push(o>>6|192),r.push(o&63|128);continue}if(o<55296||o>=57344&&o<65536){r.push(o>>12|224),r.push(o>>6&63|128),r.push(o&63|128);continue}if(o>=65536&&o<=1114111){r.push(o>>18|240),r.push(o>>12&63|128),r.push(o>>6&63|128),r.push(o&63|128);continue}r.push(239,191,189)}return new Uint8Array(r).buffer},Q={exports:{}},T=typeof Reflect=="object"?Reflect:null,re=T&&typeof T.apply=="function"?T.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},j;T&&typeof T.ownKeys=="function"?j=T.ownKeys:Object.getOwnPropertySymbols?j=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:j=function(t){return Object.getOwnPropertyNames(t)};function $e(e){console&&console.warn&&console.warn(e)}var ye=Number.isNaN||function(t){return t!==t};function b(){b.init.call(this)}Q.exports=b;Q.exports.once=ze;b.EventEmitter=b;b.prototype._events=void 0;b.prototype._eventsCount=0;b.prototype._maxListeners=void 0;var ne=10;function H(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(b,"defaultMaxListeners",{enumerable:!0,get:function(){return ne},set:function(e){if(typeof e!="number"||e<0||ye(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");ne=e}});b.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};b.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||ye(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function _e(e){return e._maxListeners===void 0?b.defaultMaxListeners:e._maxListeners}b.prototype.getMaxListeners=function(){return _e(this)};b.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var s=t==="error",o=this._events;if(o!==void 0)s=s&&o.error===void 0;else if(!s)return!1;if(s){var i;if(r.length>0&&(i=r[0]),i instanceof Error)throw i;var a=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw a.context=i,a}var u=o[t];if(u===void 0)return!1;if(typeof u=="function")re(u,this,r);else for(var c=u.length,f=Ee(u,c),n=0;n<c;++n)re(f[n],this,r);return!0};function ve(e,t,r,n){var s,o,i;if(H(r),o=e._events,o===void 0?(o=e._events=Object.create(null),e._eventsCount=0):(o.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),i=o[t]),i===void 0)i=o[t]=r,++e._eventsCount;else if(typeof i=="function"?i=o[t]=n?[r,i]:[i,r]:n?i.unshift(r):i.push(r),s=_e(e),s>0&&i.length>s&&!i.warned){i.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=i.length,$e(a)}return e}b.prototype.addListener=function(t,r){return ve(this,t,r,!1)};b.prototype.on=b.prototype.addListener;b.prototype.prependListener=function(t,r){return ve(this,t,r,!0)};function He(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function be(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=He.bind(n);return s.listener=r,n.wrapFn=s,s}b.prototype.once=function(t,r){return H(r),this.on(t,be(this,t,r)),this};b.prototype.prependOnceListener=function(t,r){return H(r),this.prependListener(t,be(this,t,r)),this};b.prototype.removeListener=function(t,r){var n,s,o,i,a;if(H(r),s=this._events,s===void 0)return this;if(n=s[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete s[t],s.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===r||n[i].listener===r){a=n[i].listener,o=i;break}if(o<0)return this;o===0?n.shift():De(n,o),n.length===1&&(s[t]=n[0]),s.removeListener!==void 0&&this.emit("removeListener",t,a||r)}return this};b.prototype.off=b.prototype.removeListener;b.prototype.removeAllListeners=function(t){var r,n,s;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var o=Object.keys(n),i;for(s=0;s<o.length;++s)i=o[s],i!=="removeListener"&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(s=r.length-1;s>=0;s--)this.removeListener(t,r[s]);return this};function we(e,t,r){var n=e._events;if(n===void 0)return[];var s=n[t];return s===void 0?[]:typeof s=="function"?r?[s.listener||s]:[s]:r?Ue(s):Ee(s,s.length)}b.prototype.listeners=function(t){return we(this,t,!0)};b.prototype.rawListeners=function(t){return we(this,t,!1)};b.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Be.call(e,t)};b.prototype.listenerCount=Be;function Be(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}b.prototype.eventNames=function(){return this._eventsCount>0?j(this._events):[]};function Ee(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function De(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Ue(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function ze(e,t){return new Promise(function(r,n){function s(i){e.removeListener(t,o),n(i)}function o(){typeof e.removeListener=="function"&&e.removeListener("error",s),r([].slice.call(arguments))}ke(e,t,o,{once:!0}),t!=="error"&&We(e,s,{once:!0})})}function We(e,t,r){typeof e.on=="function"&&ke(e,"error",t,r)}function ke(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function s(o){n.once&&e.removeEventListener(t,s),r(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var qe=Q.exports;const Rr=pe(qe);var Je={},D={},O={},Ve=F&&F.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(O,"__esModule",{value:!0});O.BaseBlockTracker=void 0;const Ke=Ve(G),Ge=1e3,Qe=(e,t)=>e+t,se=["sync","latest"];class Xe extends Ke.default{constructor(t){super(),this._blockResetDuration=t.blockResetDuration||20*Ge,this._usePastBlocks=t.usePastBlocks||!1,this._currentBlock=null,this._isRunning=!1,this._onNewListener=this._onNewListener.bind(this),this._onRemoveListener=this._onRemoveListener.bind(this),this._resetCurrentBlock=this._resetCurrentBlock.bind(this),this._setupInternalEvents()}async destroy(){this._cancelBlockResetTimeout(),await this._maybeEnd(),super.removeAllListeners()}isRunning(){return this._isRunning}getCurrentBlock(){return this._currentBlock}async getLatestBlock(){return this._currentBlock?this._currentBlock:await new Promise(r=>this.once("latest",r))}removeAllListeners(t){return t?super.removeAllListeners(t):super.removeAllListeners(),this._setupInternalEvents(),this._onRemoveListener(),this}_setupInternalEvents(){this.removeListener("newListener",this._onNewListener),this.removeListener("removeListener",this._onRemoveListener),this.on("newListener",this._onNewListener),this.on("removeListener",this._onRemoveListener)}_onNewListener(t){se.includes(t)&&this._maybeStart()}_onRemoveListener(){this._getBlockTrackerEventCount()>0||this._maybeEnd()}async _maybeStart(){this._isRunning||(this._isRunning=!0,this._cancelBlockResetTimeout(),await this._start(),this.emit("_started"))}async _maybeEnd(){this._isRunning&&(this._isRunning=!1,this._setupBlockResetTimeout(),await this._end(),this.emit("_ended"))}_getBlockTrackerEventCount(){return se.map(t=>this.listenerCount(t)).reduce(Qe)}_shouldUseNewBlock(t){const r=this._currentBlock;if(!r)return!0;const n=oe(t),s=oe(r);return this._usePastBlocks&&n<s||n>s}_newPotentialLatest(t){this._shouldUseNewBlock(t)&&this._setCurrentBlock(t)}_setCurrentBlock(t){const r=this._currentBlock;this._currentBlock=t,this.emit("latest",t),this.emit("sync",{oldBlock:r,newBlock:t})}_setupBlockResetTimeout(){this._cancelBlockResetTimeout(),this._blockResetTimeout=setTimeout(this._resetCurrentBlock,this._blockResetDuration),this._blockResetTimeout.unref&&this._blockResetTimeout.unref()}_cancelBlockResetTimeout(){this._blockResetTimeout&&clearTimeout(this._blockResetTimeout)}_resetCurrentBlock(){this._currentBlock=null}}O.BaseBlockTracker=Xe;function oe(e){return Number.parseInt(e,16)}var Le={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createModuleLogger=e.projectLogger=void 0;const t=Ne;Object.defineProperty(e,"createModuleLogger",{enumerable:!0,get:function(){return t.createModuleLogger}}),e.projectLogger=(0,t.createProjectLogger)("eth-block-tracker")})(Le);var Re=F&&F.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(D,"__esModule",{value:!0});D.PollingBlockTracker=void 0;const Ye=Re(K),Ze=Re(Oe),et=O,ie=Le,ae=(0,ie.createModuleLogger)(ie.projectLogger,"polling-block-tracker"),tt=(0,Ye.default)(),rt=1e3;class nt extends et.BaseBlockTracker{constructor(t={}){var r;if(!t.provider)throw new Error("PollingBlockTracker - no provider specified.");super(Object.assign(Object.assign({},t),{blockResetDuration:(r=t.blockResetDuration)!==null&&r!==void 0?r:t.pollingInterval})),this._provider=t.provider,this._pollingInterval=t.pollingInterval||20*rt,this._retryTimeout=t.retryTimeout||this._pollingInterval/10,this._keepEventLoopActive=t.keepEventLoopActive===void 0?!0:t.keepEventLoopActive,this._setSkipCacheFlag=t.setSkipCacheFlag||!1}async checkForLatestBlock(){return await this._updateLatestBlock(),await this.getLatestBlock()}async _start(){this._synchronize()}async _end(){}async _synchronize(){for(var t;this._isRunning;)try{await this._updateLatestBlock();const r=ce(this._pollingInterval,!this._keepEventLoopActive);this.emit("_waitingForNextIteration"),await r}catch(r){const n=new Error(`PollingBlockTracker - encountered an error while attempting to update latest block:
${(t=r.stack)!==null&&t!==void 0?t:r}`);try{this.emit("error",n)}catch{console.error(n)}const s=ce(this._retryTimeout,!this._keepEventLoopActive);this.emit("_waitingForNextIteration"),await s}}async _updateLatestBlock(){const t=await this._fetchLatestBlock();this._newPotentialLatest(t)}async _fetchLatestBlock(){const t={jsonrpc:"2.0",id:tt(),method:"eth_blockNumber",params:[]};this._setSkipCacheFlag&&(t.skipCache=!0),ae("Making request",t);const r=await(0,Ze.default)(n=>this._provider.sendAsync(t,n))();if(ae("Got response",r),r.error)throw new Error(`PollingBlockTracker - encountered error fetching block:
${r.error.message}`);return r.result}}D.PollingBlockTracker=nt;function ce(e,t){return new Promise(r=>{const n=setTimeout(r,e);n.unref&&t&&n.unref()})}var U={},st=F&&F.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(U,"__esModule",{value:!0});U.SubscribeBlockTracker=void 0;const ot=st(K),it=O,at=(0,ot.default)();class ct extends it.BaseBlockTracker{constructor(t={}){if(!t.provider)throw new Error("SubscribeBlockTracker - no provider specified.");super(t),this._provider=t.provider,this._subscriptionId=null}async checkForLatestBlock(){return await this.getLatestBlock()}async _start(){if(this._subscriptionId===void 0||this._subscriptionId===null)try{const t=await this._call("eth_blockNumber");this._subscriptionId=await this._call("eth_subscribe","newHeads"),this._provider.on("data",this._handleSubData.bind(this)),this._newPotentialLatest(t)}catch(t){this.emit("error",t)}}async _end(){if(this._subscriptionId!==null&&this._subscriptionId!==void 0)try{await this._call("eth_unsubscribe",this._subscriptionId),this._subscriptionId=null}catch(t){this.emit("error",t)}}_call(t,...r){return new Promise((n,s)=>{this._provider.sendAsync({id:at(),method:t,params:r,jsonrpc:"2.0"},(o,i)=>{o?s(o):n(i.result)})})}_handleSubData(t,r){var n;r.method==="eth_subscription"&&((n=r.params)===null||n===void 0?void 0:n.subscription)===this._subscriptionId&&this._newPotentialLatest(r.params.result.number)}}U.SubscribeBlockTracker=ct;(function(e){var t=F&&F.__createBinding||(Object.create?function(n,s,o,i){i===void 0&&(i=o),Object.defineProperty(n,i,{enumerable:!0,get:function(){return s[o]}})}:function(n,s,o,i){i===void 0&&(i=o),n[i]=s[o]}),r=F&&F.__exportStar||function(n,s){for(var o in n)o!=="default"&&!Object.prototype.hasOwnProperty.call(s,o)&&t(s,n,o)};Object.defineProperty(e,"__esModule",{value:!0}),r(D,e),r(U,e)})(Je);var ut={},C={};Object.defineProperty(C,"__esModule",{value:!0});C.EthereumProviderError=C.EthereumRpcError=void 0;const lt=Ae;class Fe extends Error{constructor(t,r,n){if(!Number.isInteger(t))throw new Error('"code" must be an integer.');if(!r||typeof r!="string")throw new Error('"message" must be a nonempty string.');super(r),this.code=t,n!==void 0&&(this.data=n)}serialize(){const t={code:this.code,message:this.message};return this.data!==void 0&&(t.data=this.data),this.stack&&(t.stack=this.stack),t}toString(){return lt.default(this.serialize(),ht,2)}}C.EthereumRpcError=Fe;class dt extends Fe{constructor(t,r,n){if(!ft(t))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(t,r,n)}}C.EthereumProviderError=dt;function ft(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}function ht(e,t){if(t!=="[Circular]")return t}var X={},x={};Object.defineProperty(x,"__esModule",{value:!0});x.errorValues=x.errorCodes=void 0;x.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}};x.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.serializeError=e.isValidCode=e.getMessageFromCode=e.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const t=x,r=C,n=t.errorCodes.rpc.internal,s="Unspecified error message. This is a bug, please report it.",o={code:n,message:i(n)};e.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.";function i(d,y=s){if(Number.isInteger(d)){const _=d.toString();if(h(t.errorValues,_))return t.errorValues[_].message;if(c(d))return e.JSON_RPC_SERVER_ERROR_MESSAGE}return y}e.getMessageFromCode=i;function a(d){if(!Number.isInteger(d))return!1;const y=d.toString();return!!(t.errorValues[y]||c(d))}e.isValidCode=a;function u(d,{fallbackError:y=o,shouldIncludeStack:_=!1}={}){var E,g;if(!y||!Number.isInteger(y.code)||typeof y.message!="string")throw new Error("Must provide fallback error with integer number code and string message.");if(d instanceof r.EthereumRpcError)return d.serialize();const w={};if(d&&typeof d=="object"&&!Array.isArray(d)&&h(d,"code")&&a(d.code)){const l=d;w.code=l.code,l.message&&typeof l.message=="string"?(w.message=l.message,h(l,"data")&&(w.data=l.data)):(w.message=i(w.code),w.data={originalError:f(d)})}else{w.code=y.code;const l=(E=d)===null||E===void 0?void 0:E.message;w.message=l&&typeof l=="string"?l:y.message,w.data={originalError:f(d)}}const p=(g=d)===null||g===void 0?void 0:g.stack;return _&&d&&p&&typeof p=="string"&&(w.stack=p),w}e.serializeError=u;function c(d){return d>=-32099&&d<=-32e3}function f(d){return d&&typeof d=="object"&&!Array.isArray(d)?Object.assign({},d):d}function h(d,y){return Object.prototype.hasOwnProperty.call(d,y)}})(X);var z={};Object.defineProperty(z,"__esModule",{value:!0});z.ethErrors=void 0;const Y=C,Ce=X,L=x;z.ethErrors={rpc:{parse:e=>R(L.errorCodes.rpc.parse,e),invalidRequest:e=>R(L.errorCodes.rpc.invalidRequest,e),invalidParams:e=>R(L.errorCodes.rpc.invalidParams,e),methodNotFound:e=>R(L.errorCodes.rpc.methodNotFound,e),internal:e=>R(L.errorCodes.rpc.internal,e),server:e=>{if(!e||typeof e!="object"||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return R(t,e)},invalidInput:e=>R(L.errorCodes.rpc.invalidInput,e),resourceNotFound:e=>R(L.errorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>R(L.errorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>R(L.errorCodes.rpc.transactionRejected,e),methodNotSupported:e=>R(L.errorCodes.rpc.methodNotSupported,e),limitExceeded:e=>R(L.errorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>I(L.errorCodes.provider.userRejectedRequest,e),unauthorized:e=>I(L.errorCodes.provider.unauthorized,e),unsupportedMethod:e=>I(L.errorCodes.provider.unsupportedMethod,e),disconnected:e=>I(L.errorCodes.provider.disconnected,e),chainDisconnected:e=>I(L.errorCodes.provider.chainDisconnected,e),custom:e=>{if(!e||typeof e!="object"||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:t,message:r,data:n}=e;if(!r||typeof r!="string")throw new Error('"message" must be a nonempty string');return new Y.EthereumProviderError(t,r,n)}}};function R(e,t){const[r,n]=xe(t);return new Y.EthereumRpcError(e,r||Ce.getMessageFromCode(e),n)}function I(e,t){const[r,n]=xe(t);return new Y.EthereumProviderError(e,r||Ce.getMessageFromCode(e),n)}function xe(e){if(e){if(typeof e=="string")return[e];if(typeof e=="object"&&!Array.isArray(e)){const{message:t,data:r}=e;if(t&&typeof t!="string")throw new Error("Must specify string message.");return[t||void 0,r]}}return[]}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getMessageFromCode=e.serializeError=e.EthereumProviderError=e.EthereumRpcError=e.ethErrors=e.errorCodes=void 0;const t=C;Object.defineProperty(e,"EthereumRpcError",{enumerable:!0,get:function(){return t.EthereumRpcError}}),Object.defineProperty(e,"EthereumProviderError",{enumerable:!0,get:function(){return t.EthereumProviderError}});const r=X;Object.defineProperty(e,"serializeError",{enumerable:!0,get:function(){return r.serializeError}}),Object.defineProperty(e,"getMessageFromCode",{enumerable:!0,get:function(){return r.getMessageFromCode}});const n=z;Object.defineProperty(e,"ethErrors",{enumerable:!0,get:function(){return n.ethErrors}});const s=x;Object.defineProperty(e,"errorCodes",{enumerable:!0,get:function(){return s.errorCodes}})})(ut);const pt=je,mt=K();var gt=m;function m(e){const t=this;t.currentProvider=e}m.prototype.getBalance=N(2,"eth_getBalance");m.prototype.getCode=N(2,"eth_getCode");m.prototype.getTransactionCount=N(2,"eth_getTransactionCount");m.prototype.getStorageAt=N(3,"eth_getStorageAt");m.prototype.call=N(2,"eth_call");m.prototype.protocolVersion=v("eth_protocolVersion");m.prototype.syncing=v("eth_syncing");m.prototype.coinbase=v("eth_coinbase");m.prototype.mining=v("eth_mining");m.prototype.hashrate=v("eth_hashrate");m.prototype.gasPrice=v("eth_gasPrice");m.prototype.accounts=v("eth_accounts");m.prototype.blockNumber=v("eth_blockNumber");m.prototype.getBlockTransactionCountByHash=v("eth_getBlockTransactionCountByHash");m.prototype.getBlockTransactionCountByNumber=v("eth_getBlockTransactionCountByNumber");m.prototype.getUncleCountByBlockHash=v("eth_getUncleCountByBlockHash");m.prototype.getUncleCountByBlockNumber=v("eth_getUncleCountByBlockNumber");m.prototype.sign=v("eth_sign");m.prototype.sendTransaction=v("eth_sendTransaction");m.prototype.sendRawTransaction=v("eth_sendRawTransaction");m.prototype.estimateGas=v("eth_estimateGas");m.prototype.getBlockByHash=v("eth_getBlockByHash");m.prototype.getBlockByNumber=v("eth_getBlockByNumber");m.prototype.getTransactionByHash=v("eth_getTransactionByHash");m.prototype.getTransactionByBlockHashAndIndex=v("eth_getTransactionByBlockHashAndIndex");m.prototype.getTransactionByBlockNumberAndIndex=v("eth_getTransactionByBlockNumberAndIndex");m.prototype.getTransactionReceipt=v("eth_getTransactionReceipt");m.prototype.getUncleByBlockHashAndIndex=v("eth_getUncleByBlockHashAndIndex");m.prototype.getUncleByBlockNumberAndIndex=v("eth_getUncleByBlockNumberAndIndex");m.prototype.getCompilers=v("eth_getCompilers");m.prototype.compileLLL=v("eth_compileLLL");m.prototype.compileSolidity=v("eth_compileSolidity");m.prototype.compileSerpent=v("eth_compileSerpent");m.prototype.newFilter=v("eth_newFilter");m.prototype.newBlockFilter=v("eth_newBlockFilter");m.prototype.newPendingTransactionFilter=v("eth_newPendingTransactionFilter");m.prototype.uninstallFilter=v("eth_uninstallFilter");m.prototype.getFilterChanges=v("eth_getFilterChanges");m.prototype.getFilterLogs=v("eth_getFilterLogs");m.prototype.getLogs=v("eth_getLogs");m.prototype.getWork=v("eth_getWork");m.prototype.submitWork=v("eth_submitWork");m.prototype.submitHashrate=v("eth_submitHashrate");m.prototype.sendAsync=function(e,t){this.currentProvider.sendAsync(yt(e),function(n,s){if(!n&&s.error&&(n=new Error("EthQuery - RPC Error - "+s.error.message)),n)return t(n);t(null,s.result)})};function v(e){return function(){const t=this;var r=[].slice.call(arguments),n=r.pop();t.sendAsync({method:e,params:r},n)}}function N(e,t){return function(){const r=this;var n=[].slice.call(arguments),s=n.pop();n.length<e&&n.push("latest"),r.sendAsync({method:t,params:n},s)}}function yt(e){return pt({id:mt(),jsonrpc:"2.0",params:[]},e)}const ue=(e,t,r,n)=>function(...s){const o=t.promiseModule;return new o((i,a)=>{t.multiArgs?s.push((...c)=>{t.errorFirst?c[0]?a(c):(c.shift(),i(c)):i(c)}):t.errorFirst?s.push((c,f)=>{c?a(c):i(f)}):s.push(i),Reflect.apply(e,this===r?n:this,s)})},le=new WeakMap;var _t=(e,t)=>{t={exclude:[/.+(?:Sync|Stream)$/],errorFirst:!0,promiseModule:Promise,...t};const r=typeof e;if(!(e!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${e===null?"null":r}\``);const n=(i,a)=>{let u=le.get(i);if(u||(u={},le.set(i,u)),a in u)return u[a];const c=_=>typeof _=="string"||typeof a=="symbol"?a===_:_.test(a),f=Reflect.getOwnPropertyDescriptor(i,a),h=f===void 0||f.writable||f.configurable,y=(t.include?t.include.some(c):!t.exclude.some(c))&&h;return u[a]=y,y},s=new WeakMap,o=new Proxy(e,{apply(i,a,u){const c=s.get(i);if(c)return Reflect.apply(c,a,u);const f=t.excludeMain?i:ue(i,t,o,i);return s.set(i,f),Reflect.apply(f,a,u)},get(i,a){const u=i[a];if(!n(i,a)||u===Function.prototype[a])return u;const c=s.get(u);if(c)return c;if(typeof u=="function"){const f=ue(u,t,o,i);return s.set(u,f),f}return u}});return o};const vt=G.default;let bt=class extends vt{constructor(){super(),this.updates=[]}async initialize(){}async update(){throw new Error("BaseFilter - no update method specified")}addResults(t){this.updates=this.updates.concat(t),t.forEach(r=>this.emit("update",r))}addInitialResults(t){}getChangesAndClear(){const t=this.updates;return this.updates=[],t}};var Z=bt;const wt=Z;let Bt=class extends wt{constructor(){super(),this.allResults=[]}async update(){throw new Error("BaseFilterWithHistory - no update method specified")}addResults(t){this.allResults=this.allResults.concat(t),super.addResults(t)}addInitialResults(t){this.allResults=this.allResults.concat(t),super.addInitialResults(t)}getAllResults(){return this.allResults}};var Et=Bt,A={minBlockRef:kt,maxBlockRef:Lt,sortBlockRefs:ee,bnToHex:Rt,blockRefIsNumber:Ft,hexToInt:$,incrementHexInt:Ct,intToHex:Pe,unsafeRandomBytes:xt};function kt(...e){return ee(e)[0]}function Lt(...e){const t=ee(e);return t[t.length-1]}function ee(e){return e.sort((t,r)=>t==="latest"||r==="earliest"?1:r==="latest"||t==="earliest"?-1:$(t)-$(r))}function Rt(e){return"0x"+e.toString(16)}function Ft(e){return e&&!["earliest","latest","pending"].includes(e)}function $(e){return e==null?e:Number.parseInt(e,16)}function Ct(e){if(e==null)return e;const t=$(e);return Pe(t+1)}function Pe(e){if(e==null)return e;let t=e.toString(16);return t.length%2&&(t="0"+t),"0x"+t}function xt(e){let t="0x";for(let r=0;r<e;r++)t+=de(),t+=de();return t}function de(){return Math.floor(Math.random()*16).toString(16)}const Pt=gt,Tt=_t,It=Et,{bnToHex:xr,hexToInt:M,incrementHexInt:Ot,minBlockRef:Nt,blockRefIsNumber:At}=A;let Mt=class extends It{constructor({provider:t,params:r}){super(),this.type="log",this.ethQuery=new Pt(t),this.params=Object.assign({fromBlock:"latest",toBlock:"latest",address:void 0,topics:[]},r),this.params.address&&(Array.isArray(this.params.address)||(this.params.address=[this.params.address]),this.params.address=this.params.address.map(n=>n.toLowerCase()))}async initialize({currentBlock:t}){let r=this.params.fromBlock;["latest","pending"].includes(r)&&(r=t),r==="earliest"&&(r="0x0"),this.params.fromBlock=r;const n=Nt(this.params.toBlock,t),s=Object.assign({},this.params,{toBlock:n}),o=await this._fetchLogs(s);this.addInitialResults(o)}async update({oldBlock:t,newBlock:r}){const n=r;let s;t?s=Ot(t):s=r;const o=Object.assign({},this.params,{fromBlock:s,toBlock:n}),a=(await this._fetchLogs(o)).filter(u=>this.matchLog(u));this.addResults(a)}async _fetchLogs(t){return await Tt(n=>this.ethQuery.getLogs(t,n))()}matchLog(t){if(M(this.params.fromBlock)>=M(t.blockNumber)||At(this.params.toBlock)&&M(this.params.toBlock)<=M(t.blockNumber))return!1;const r=t.address&&t.address.toLowerCase();return this.params.address&&r&&!this.params.address.includes(r)?!1:this.params.topics.every((s,o)=>{let i=t.topics[o];if(!i)return!1;i=i.toLowerCase();let a=Array.isArray(s)?s:[s];return a.includes(null)?!0:(a=a.map(f=>f.toLowerCase()),a.includes(i))})}};var jt=Mt,te=St;async function St({provider:e,fromBlock:t,toBlock:r}){t||(t=r);const n=fe(t),o=fe(r)-n+1,i=Array(o).fill().map((u,c)=>n+c).map($t);let a=await Promise.all(i.map(u=>Dt(e,"eth_getBlockByNumber",[u,!1])));return a=a.filter(u=>u!==null),a}function fe(e){return e==null?e:Number.parseInt(e,16)}function $t(e){return e==null?e:"0x"+e.toString(16)}function Ht(e,t){return new Promise((r,n)=>{e.sendAsync(t,(s,o)=>{s?n(s):o.error?n(o.error):o.result?r(o.result):n(new Error("Result was empty"))})})}async function Dt(e,t,r){for(let n=0;n<3;n++)try{return await Ht(e,{id:1,jsonrpc:"2.0",method:t,params:r})}catch(s){console.error(`provider.sendAsync failed: ${s.stack||s.message||s}`)}return null}const Ut=Z,zt=te,{incrementHexInt:Wt}=A;let qt=class extends Ut{constructor({provider:t,params:r}){super(),this.type="block",this.provider=t}async update({oldBlock:t,newBlock:r}){const n=r,s=Wt(t),i=(await zt({provider:this.provider,fromBlock:s,toBlock:n})).map(a=>a.hash);this.addResults(i)}};var Jt=qt;const Vt=Z,Kt=te,{incrementHexInt:Gt}=A;let Qt=class extends Vt{constructor({provider:t}){super(),this.type="tx",this.provider=t}async update({oldBlock:t}){const r=t,n=Gt(t),s=await Kt({provider:this.provider,fromBlock:n,toBlock:r}),o=[];for(const i of s)o.push(...i.transactions);this.addResults(o)}};var Xt=Qt;const Yt=Me.Mutex,{createAsyncMiddleware:Zt,createScaffoldMiddleware:er}=me,tr=jt,rr=Jt,nr=Xt,{intToHex:Te,hexToInt:J}=A;var sr=or;function or({blockTracker:e,provider:t}){let r=0,n={};const s=new Yt,o=ir({mutex:s}),i=er({eth_newFilter:o(V(u)),eth_newBlockFilter:o(V(c)),eth_newPendingTransactionFilter:o(V(f)),eth_uninstallFilter:o(S(y)),eth_getFilterChanges:o(S(h)),eth_getFilterLogs:o(S(d))}),a=async({oldBlock:p,newBlock:l})=>{if(n.length===0)return;const k=await s.acquire();try{await Promise.all(P(n).map(async B=>{try{await B.update({oldBlock:p,newBlock:l})}catch(W){console.error(W)}}))}catch(B){console.error(B)}k()};return i.newLogFilter=u,i.newBlockFilter=c,i.newPendingTransactionFilter=f,i.uninstallFilter=y,i.getFilterChanges=h,i.getFilterLogs=d,i.destroy=()=>{g()},i;async function u(p){const l=new tr({provider:t,params:p});return await _(l),l}async function c(){const p=new rr({provider:t});return await _(p),p}async function f(){const p=new nr({provider:t});return await _(p),p}async function h(p){const l=J(p),k=n[l];if(!k)throw new Error(`No filter for index "${l}"`);return k.getChangesAndClear()}async function d(p){const l=J(p),k=n[l];if(!k)throw new Error(`No filter for index "${l}"`);let B=[];return k.type==="log"&&(B=k.getAllResults()),B}async function y(p){const l=J(p),B=!!n[l];return B&&await E(l),B}async function _(p){const l=P(n).length,k=await e.getLatestBlock();await p.initialize({currentBlock:k}),r++,n[r]=p,p.id=r,p.idHex=Te(r);const B=P(n).length;return w({prevFilterCount:l,newFilterCount:B}),r}async function E(p){const l=P(n).length;delete n[p];const k=P(n).length;w({prevFilterCount:l,newFilterCount:k})}async function g(){const p=P(n).length;n={},w({prevFilterCount:p,newFilterCount:0})}function w({prevFilterCount:p,newFilterCount:l}){if(p===0&&l>0){e.on("sync",a);return}if(p>0&&l===0){e.removeListener("sync",a);return}}}function V(e){return S(async(...t)=>{const r=await e(...t);return Te(r.id)})}function S(e){return Zt(async(t,r)=>{const n=await e.apply(null,t.params);r.result=n})}function ir({mutex:e}){return t=>async(r,n,s,o)=>{(await e.acquire())(),t(r,n,s,o)}}function P(e,t){const r=[];for(let n in e)r.push(e[n]);return r}const ar=G.default,{createAsyncMiddleware:he,createScaffoldMiddleware:cr}=me,ur=sr,{unsafeRandomBytes:lr,incrementHexInt:dr}=A,fr=te;var Or=hr;function hr({blockTracker:e,provider:t}){const r={},n=ur({blockTracker:e,provider:t});let s=!1;const o=new ar,i=cr({eth_subscribe:he(a),eth_unsubscribe:he(u)});return i.destroy=f,{events:o,middleware:i};async function a(h,d){if(s)throw new Error("SubscriptionManager - attempting to use after destroying");const y=h.params[0],_=lr(16);let E;switch(y){case"newHeads":E=g({subId:_});break;case"logs":const p=h.params[1],l=await n.newLogFilter(p);E=w({subId:_,filter:l});break;default:throw new Error(`SubscriptionManager - unsupported subscription type "${y}"`)}r[_]=E,d.result=_;return;function g({subId:p}){const l={type:y,destroy:async()=>{e.removeListener("sync",l.update)},update:async({oldBlock:k,newBlock:B})=>{const W=B,Ie=dr(k);(await fr({provider:t,fromBlock:Ie,toBlock:W})).map(pr).filter(q=>q!==null).forEach(q=>{c(p,q)})}};return e.on("sync",l.update),l}function w({subId:p,filter:l}){return l.on("update",B=>c(p,B)),{type:y,destroy:async()=>await n.uninstallFilter(l.idHex)}}}async function u(h,d){if(s)throw new Error("SubscriptionManager - attempting to use after destroying");const y=h.params[0],_=r[y];if(!_){d.result=!1;return}delete r[y],await _.destroy(),d.result=!0}function c(h,d){o.emit("notification",{jsonrpc:"2.0",method:"eth_subscription",params:{subscription:h,result:d}})}function f(){o.removeAllListeners();for(const h in r)r[h].destroy(),delete r[h];s=!0}}function pr(e){return e==null?null:{hash:e.hash,parentHash:e.parentHash,sha3Uncles:e.sha3Uncles,miner:e.miner,stateRoot:e.stateRoot,transactionsRoot:e.transactionsRoot,receiptsRoot:e.receiptsRoot,logsBloom:e.logsBloom,difficulty:e.difficulty,number:e.number,gasLimit:e.gasLimit,gasUsed:e.gasUsed,nonce:e.nonce,mixHash:e.mixHash,timestamp:e.timestamp,extraData:e.extraData}}export{kr as E,Rr as a,ut as b,Lr as c,Je as d,qe as e,Or as s};
